(()=>{const e=new Map([["first",{x:274,y:416}],["second",{x:274,y:98}]]),t=[{color:"red",target:"player",spawn:{x:276,y:204}},{color:"pink",target:"after",spawn:{x:238,y:258}},{color:"cyan",target:"any",spawn:{x:278,y:258}},{color:"orange",target:"random",spawn:{x:314,y:258}}],o=2*Math.PI,n=(new Map([["right",{openS:.1*o,openE:.9*o,closeS:0,closeE:o}],["left",{openS:.6*o,openE:.4*o,closeS:.49*o,closeE:.49*o}],["down",{openS:.35*o,openE:1.15*o,closeS:.25*o,closeE:1.25*o}],["up",{openS:.85*o,openE:.65*o,closeS:.74*o,closeE:.74*o}]]),550),s=550,r=getId("pacMan"),a=(r.getContext("2d"),getId("ghosts")),i=(a.getContext("2d"),getId("dots")),c=(i.getContext("2d"),getId("text")),d=(c.getContext("2d"),getId("board")),l=(d.getContext("2d"),getId("menu")),f=getId("onePlayer"),g=getId("twoPlayers"),u=getId("changeFirstControl"),p=getId("changeSecondControl"),w=getId("muteButton"),h=new Map;new Map;let m=!1;const y=new Map,k=new Map([["firstPlayer",{up:"w",left:"a",down:"s",right:"d"}],["secondPlayer",{up:"ArrowUp",left:"ArrowLeft",down:"ArrowDown",right:"ArrowRight"}]]),E={enemies:[],dots:[],text:[],fruit:null},x=0;function v(e){const t=k.get(e),o={up:t.up,left:t.left,down:t.down,right:t.right},n=function*(e){const t=document.createElement("div");t.id="block",document.body.append(t),alert("After you click OK press key for UP"),e.up=yield,alert("After you click OK press key for LEFT"),e.left=yield,alert("After you click OK press key for DOWN"),e.down=yield,alert("After you click OK press key for RIGHT"),e.right=yield,document.onkeydown=null,t.remove()}(t);n.next(),document.onkeydown=e=>{if("Escape"===e.key)return t.up=o.up,t.left=o.left,t.down=o.down,t.right=o.right,document.onkeydown=null,void document.getElementById("block").remove();n.next(e.key)}}function T(o){const n=e.get("first");if(y.set("first",new CreatePacMan(n.x,n.y,16,2,"male")),2===o){const t=e.get("second");y.set("second",new CreatePacMan(t.x,t.y,16,2,"female"))}for(const e of t)E.enemies.push(new CreateEnemy(e.spawn.x,e.spawn.y,16,2,e.color,e.target));l.style.display="none",document.onkeydown=e=>{const t=k.get("firstPlayer"),o=k.get("secondPlayer");let n="",s="";switch(e.key){case t.up:n="up",s="first";break;case t.down:n="down",s="first";break;case t.left:n="left",s="first";break;case t.right:n="right",s="first"}switch(e.key){case o.up:n="up",s="second";break;case o.down:n="down",s="second";break;case o.left:n="left",s="second";break;case o.right:n="right",s="second"}if(""!==n){if(!y.has(s))return;const e=y.get(s);e.key=n,clearTimeout(e.turnLag),e.key!==e.direction&&(e.turnLag=setTimeout((()=>{e.key=e.direction}),1e3))}},drawBoard(),drawDots(),function(){y.forEach((t=>{toBasicPosition(t,e.get("male"===t.sex?"first":"second")),t.dead=!1,clearTimeout(t.invincibleTimer),t.invincible=!1,t.invincibleTimer=0}));for(let e=0;e<E.enemies.length;e++)toBasicPosition(E.enemies[e],t[e].spawn);y.forEach((e=>{e.draw()})),E.enemies.forEach((e=>e.draw())),drawText(235,325,90,"Ready!",25,"yellow"),addTrack(h.get("openingSong")).then((()=>{eraseText(),addTrack(h.get("sirenEffect"),!1),E.dots.forEach((e=>{"powerUp"===e.type&&e.bleek(!0)})),function(){for(let e=0;e<E.enemies.length;e++){const t=E.enemies[e];clearTimeout(t.releaseTimer),t.release=!1,t.releaseTimer=0,t.releaseTimer=setTimeout((()=>{t.release=!0}),2e3*e)}}(),E.fruit?E.fruit.disappear(!0):x<2&&drawFruit(),moving(!0)}))}()}[["openingSong","opening","./assets/sound/opening_song.mp3",!1],["sirenEffect","siren","./assets/sound/siren_effect.mp3",!0],["weakGhost","weak","./assets/sound/weak_ghost.mp3",!0],["wakaEffect","waka","./assets/sound/eating_dot.mp3",!0],["eatFruit","eatFruit","./assets/sound/eat_fruit.mp3",!1],["eatGhostEffect","eatGhost","./assets/sound/eating_ghost_effect.mp3",!1],["goHomeEffect","ghostHome","./assets/sound/ghost_go_home.mp3",!0],["extraLifeEffect","extraLife","./assets/sound/extra_live_effect.mp3",!1],["dieEffect","die","./assets/sound/dies_effect.mp3",!1],["lolSong","lol","./assets/sound/lol_u_died.mp3",!0]].forEach((e=>{h.set(e[0],{id:e[1],url:new Audio(e[2])});const t=h.get(e[0]);t.url.loop=e[3],t.url.load()})),h.get("wakaEffect").url.volume=.5,alert("first player control scheme is - W - A - S - D -\nsecond player control scheme is - Arrow Up - Arrow Left - Arrow Down - Arrow Rigth"),r.width=n,r.height=s,a.width=n,a.height=s,i.width=n,i.height=s,c.width=n,c.height=s,d.width=n,d.height=s,f.addEventListener("click",(e=>{T(1)})),g.addEventListener("click",(e=>{T(2)})),u.addEventListener("click",(e=>{v("firstPlayer")})),p.addEventListener("click",(e=>{v("secondPlayer")})),w.addEventListener("click",(e=>{m=!m,w.className=m?"mute":"volume",h.forEach((e=>{e.url.volume=m?0:1}))}))})();